allocate:{
    w:"i"$x*/:y%/:sum y;
    w[k]:w[k:y?min y]+x-sum w;
    w
 }